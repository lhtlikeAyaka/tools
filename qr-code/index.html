<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºŒç»´ç ç”Ÿæˆå™¨ - LHTools</title>
    <link rel="canonical" href="https://lhttools.top/qr-code" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body { background-color: #f0f9ff; color: #1e293b; }
        .glass-box { background: white; border: 1px solid #e0f2fe; }
        /* å¼ºåˆ¶è®©ç”Ÿæˆçš„äºŒç»´ç å±…ä¸­å¹¶ä¿æŒç™½è¾¹ */
        #qrcode { display: flex; justify-content: center; }
        #qrcode img, #qrcode canvas { 
            border: 8px solid white; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        }
    </style>
</head>
<body class="min-h-screen">
    <nav class="bg-white border-b border-blue-100 p-4 flex justify-between items-center shadow-sm">
        <a href="/" class="font-bold text-blue-600 flex items-center">
            <span class="bg-blue-600 text-white px-2 rounded mr-2">LH</span> TOOLS
        </a>
        <a href="/" class="text-sm text-slate-400 hover:text-blue-600 transition">è¿”å›é¦–é¡µ / Back Home</a>
    </nav>

    <main class="container mx-auto px-4 max-w-4xl py-10">
        <div class="flex flex-col md:flex-row gap-8">
            <div class="bg-white p-6 rounded-2xl shadow-sm flex-1 glass-box">
                <label class="block text-sm font-bold text-slate-600 mb-2">è¾“å…¥é“¾æ¥æˆ–æ–‡å­— / Content</label>
                <textarea id="textInput" class="w-full h-40 p-4 bg-slate-50 border border-blue-100 rounded-xl outline-none focus:ring-2 focus:ring-blue-400 transition mb-4" oninput="gen()">https://lhttools.top</textarea>
                
                <button onclick="downloadQR()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-bold shadow-lg shadow-blue-100 transition flex items-center justify-center">
                    <span class="mr-2">ğŸ’¾</span> ä¸‹è½½äºŒç»´ç å›¾ç‰‡ (PNG)
                </button>
                <p class="text-center text-xs text-slate-400 mt-4">æ‰€æœ‰ç”Ÿæˆå‡åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä¿æŠ¤éšç§</p>
            </div>

            <div class="bg-white p-10 rounded-3xl shadow-xl flex-1 text-center flex flex-col justify-center items-center glass-box">
                <div id="qrcode"></div>
                <div class="mt-6 text-sm text-slate-400 font-medium">é¢„è§ˆ / Preview</div>
            </div>
        </div>
    </main>

    <script>
        const qrcodeElem = document.getElementById("qrcode");
        const textInput = document.getElementById("textInput");
        
        // åˆå§‹åŒ–äºŒç»´ç å¯¹è±¡
        let qr = new QRCode(qrcodeElem, {
            text: "https://lhttools.top",
            width: 256,
            height: 256,
            colorDark: "#000000",
            colorLight: "#ffffff",
            correctLevel: QRCode.CorrectLevel.H
        });

        // å®æ—¶ç”Ÿæˆå‡½æ•°
        function gen() {
            const val = textInput.value.trim();
            qr.clear(); 
            qr.makeCode(val || " ");
        }

        // ä¿®å¤åçš„ä¸‹è½½å‡½æ•°
        function downloadQR() {
            // qrcode.js æœ‰æ—¶ç”Ÿæˆ canvas, æœ‰æ—¶ç”Ÿæˆ img
            const img = qrcodeElem.querySelector('img');
            const canvas = qrcodeElem.querySelector('canvas');
            
            let dataUrl = "";
            
            if (img && img.src && !img.src.startsWith('data:image/svg')) {
                dataUrl = img.src;
            } else if (canvas) {
                dataUrl = canvas.toDataURL("image/png");
            }

            if (dataUrl) {
                const link = document.createElement("a");
                link.href = dataUrl;
                link.download = `LHTools-QR-${Date.now()}.png`; // ç¡®ä¿æ–‡ä»¶åä»¥ .png ç»“å°¾
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("ç”Ÿæˆå¤±è´¥ï¼Œè¯·å°è¯•åˆ·æ–°é¡µé¢");
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨ç”Ÿæˆä¸€æ¬¡
        window.onload = gen;
    </script>
</body>
</html>
